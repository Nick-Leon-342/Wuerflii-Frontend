{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/nickl/Desktop/Git Projects/kniffel/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/nickl/Desktop/Git Projects/kniffel/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/nickl/Desktop/Git Projects/kniffel/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{Outlet,useNavigate}from'react-router-dom';import{useState,useEffect}from'react';import useRefreshToken from'../hooks/useRefreshToken';import useAuth from'../hooks/useAuth';import{clearSessionStorage}from'./utils';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var PersistLogin=function PersistLogin(){var navigate=useNavigate();var _useState=useState(true),_useState2=_slicedToArray(_useState,2),isLoading=_useState2[0],setIsLoading=_useState2[1];var refresh=useRefreshToken();var _useAuth=useAuth(),auth=_useAuth.auth;useEffect(function(){var verifyRefreshToken=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return refresh();case 3:_context.next=9;break;case 5:_context.prev=5;_context.t0=_context[\"catch\"](0);clearSessionStorage();navigate('/login');case 9:_context.prev=9;setIsLoading(false);return _context.finish(9);case 12:case\"end\":return _context.stop();}},_callee,null,[[0,5,9,12]]);}));return function verifyRefreshToken(){return _ref.apply(this,arguments);};}();!(auth!==null&&auth!==void 0&&auth.accessToken)?verifyRefreshToken():setIsLoading(false);},[]);return/*#__PURE__*/_jsx(_Fragment,{children:isLoading?/*#__PURE__*/_jsx(\"p\",{children:\"Loading...\"}):/*#__PURE__*/_jsx(Outlet,{})});};export default PersistLogin;","map":{"version":3,"names":["Outlet","useNavigate","useState","useEffect","useRefreshToken","useAuth","clearSessionStorage","jsx","_jsx","Fragment","_Fragment","PersistLogin","navigate","_useState","_useState2","_slicedToArray","isLoading","setIsLoading","refresh","_useAuth","auth","verifyRefreshToken","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","t0","finish","stop","apply","arguments","accessToken","children"],"sources":["C:/Users/nickl/Desktop/Git Projects/kniffel/src/pages/PersistLogin.js"],"sourcesContent":["\r\n\r\nimport { Outlet, useNavigate } from 'react-router-dom'\r\nimport { useState, useEffect } from 'react'\r\nimport useRefreshToken from '../hooks/useRefreshToken'\r\nimport useAuth from '../hooks/useAuth'\r\nimport { clearSessionStorage } from './utils'\r\n\r\nconst PersistLogin = () => {\r\n\r\n\tconst navigate = useNavigate()\r\n\tconst [isLoading, setIsLoading] = useState(true)\r\n\tconst refresh = useRefreshToken()\r\n\tconst { auth } = useAuth()\r\n\r\n\tuseEffect(() => {\r\n\t\t\r\n\t\tconst verifyRefreshToken = async () => {\r\n\t\t\ttry {\r\n\t\t\t\tawait refresh()\r\n\t\t\t} catch(err) {\r\n\t\t\t\tclearSessionStorage()\r\n\t\t\t\tnavigate('/login')\r\n\t\t\t} finally {\r\n\t\t\t\tsetIsLoading(false)\r\n\t\t\t}\r\n\t\t} \r\n\t\r\n\t\t!auth?.accessToken ? verifyRefreshToken() : setIsLoading(false)\r\n\r\n\t}, [])\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{isLoading ? <p>Loading...</p> : <Outlet/>}\r\n\t\t</>\r\n\t)\r\n\t\r\n}\r\n\r\nexport default PersistLogin\r\n"],"mappings":"mZAEA,OAASA,MAAM,CAAEC,WAAW,KAAQ,kBAAkB,CACtD,OAASC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAC3C,MAAO,CAAAC,eAAe,KAAM,0BAA0B,CACtD,MAAO,CAAAC,OAAO,KAAM,kBAAkB,CACtC,OAASC,mBAAmB,KAAQ,SAAS,QAAAC,GAAA,IAAAC,IAAA,gCAAAC,QAAA,IAAAC,SAAA,yBAE7C,GAAM,CAAAC,YAAY,CAAG,QAAf,CAAAA,YAAYA,CAAA,CAAS,CAE1B,GAAM,CAAAC,QAAQ,CAAGX,WAAW,CAAC,CAAC,CAC9B,IAAAY,SAAA,CAAkCX,QAAQ,CAAC,IAAI,CAAC,CAAAY,UAAA,CAAAC,cAAA,CAAAF,SAAA,IAAzCG,SAAS,CAAAF,UAAA,IAAEG,YAAY,CAAAH,UAAA,IAC9B,GAAM,CAAAI,OAAO,CAAGd,eAAe,CAAC,CAAC,CACjC,IAAAe,QAAA,CAAiBd,OAAO,CAAC,CAAC,CAAlBe,IAAI,CAAAD,QAAA,CAAJC,IAAI,CAEZjB,SAAS,CAAC,UAAM,CAEf,GAAM,CAAAkB,kBAAkB,6BAAAC,IAAA,CAAAC,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CAAG,SAAAC,QAAA,SAAAF,mBAAA,GAAAG,IAAA,UAAAC,SAAAC,QAAA,iBAAAA,QAAA,CAAAC,IAAA,CAAAD,QAAA,CAAAE,IAAA,SAAAF,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA,SAEnB,CAAAb,OAAO,CAAC,CAAC,QAAAW,QAAA,CAAAE,IAAA,gBAAAF,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAG,EAAA,CAAAH,QAAA,aAEfvB,mBAAmB,CAAC,CAAC,CACrBM,QAAQ,CAAC,QAAQ,CAAC,QAAAiB,QAAA,CAAAC,IAAA,GAElBb,YAAY,CAAC,KAAK,CAAC,QAAAY,QAAA,CAAAI,MAAA,6BAAAJ,QAAA,CAAAK,IAAA,MAAAR,OAAA,qBAEpB,kBATK,CAAAL,kBAAkBA,CAAA,SAAAC,IAAA,CAAAa,KAAA,MAAAC,SAAA,OASvB,CAED,EAAChB,IAAI,SAAJA,IAAI,WAAJA,IAAI,CAAEiB,WAAW,EAAGhB,kBAAkB,CAAC,CAAC,CAAGJ,YAAY,CAAC,KAAK,CAAC,CAEhE,CAAC,CAAE,EAAE,CAAC,CAEN,mBACCT,IAAA,CAAAE,SAAA,EAAA4B,QAAA,CACEtB,SAAS,cAAGR,IAAA,MAAA8B,QAAA,CAAG,YAAU,CAAG,CAAC,cAAG9B,IAAA,CAACR,MAAM,GAAC,CAAC,CACzC,CAAC,CAGL,CAAC,CAED,cAAe,CAAAW,YAAY"},"metadata":{},"sourceType":"module","externalDependencies":[]}